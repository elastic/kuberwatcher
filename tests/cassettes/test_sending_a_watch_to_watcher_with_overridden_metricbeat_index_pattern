interactions:
- request:
    body: null
    headers:
      connection:
      - keep-alive
      content-type:
      - application/json
    method: GET
    uri: http://localhost:9200/.watches/_search?size=1000
  response:
    body:
      string: '{"took":1,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":4,"max_score":1.0,"hits":[{"_index":".watches","_type":"doc","_id":"disabled.nginx","_score":1.0,"_source":{"trigger":{"schedule":{"interval":"30s"}},"input":{"search":{"request":{"search_type":"query_then_fetch","indices":["metricbeat-*"],"types":[],"body":{"aggs":{"result":{"top_hits":{"size":1}},"pods":{"cardinality":{"field":"kubernetes.pod.name"}},"not_ready":{"terms":{"field":"kubernetes.pod.name","min_doc_count":12,"size":100}}},"query":{"bool":{"must_not":[{"match":{"kubernetes.pod.status.ready":"true"}}],"must":[{"regexp":{"kubernetes.pod.name":"nginx-[^-]+-[^-]+"}},{"match":{"kubernetes.namespace":"disabled"}},{"match":{"metricset.name":"state_pod"}}],"filter":[{"range":{"@timestamp":{"gte":"now-{{ctx.metadata.window}}"}}}]}}}}}},"condition":{"compare":{"ctx.payload.aggregations.not_ready.buckets":{"not_eq":[]}}},"actions":{},"metadata":{"regex":"nginx-%5B%5E-%5D%2B-%5B%5E-%5D%2B","docs":"","name":"disabled.nginx","namespace":"disabled","window":"300s","kibana_url":"https://kibana.example.com","kibana_dashboard":"","xpack":{"type":"json"}},"status":{"state":{"active":true,"timestamp":"2019-03-15T15:26:53.124Z"},"actions":{},"headers":{"_xpack_security_authentication":"w6XxAgAHZWxhc3RpYwEJc3VwZXJ1c2VyCgEJX3Jlc2VydmVkBQEAAAEAB3ZKWGJMRG4IcmVzZXJ2ZWQIcmVzZXJ2ZWQA"},"version":-1}}},{"_index":".watches","_type":"doc","_id":"test.nginx","_score":1.0,"_source":{"trigger":{"schedule":{"interval":"30s"}},"input":{"search":{"request":{"search_type":"query_then_fetch","indices":["metricbeat-*"],"types":[],"body":{"aggs":{"result":{"top_hits":{"size":1}},"pods":{"cardinality":{"field":"kubernetes.pod.name"}},"not_ready":{"terms":{"field":"kubernetes.pod.name","min_doc_count":12,"size":100}}},"query":{"bool":{"must_not":[{"match":{"kubernetes.pod.status.ready":"true"}}],"must":[{"regexp":{"kubernetes.pod.name":"nginx-[^-]+-[^-]+"}},{"match":{"kubernetes.namespace":"test"}},{"match":{"metricset.name":"state_pod"}}],"filter":[{"range":{"@timestamp":{"gte":"now-{{ctx.metadata.window}}"}}}]}}}}}},"condition":{"compare":{"ctx.payload.aggregations.not_ready.buckets":{"not_eq":[]}}},"actions":{"email_admin":{"throttle_period_in_millis":3600000,"email":{"profile":"standard","to":["michael.russell@elastic.co"],"subject":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}{{ctx.metadata.name}}
        has {{ctx.payload.aggregations.pods.value}} not ready pod(s){{/ctx.payload.aggregations.result.hits.hits.0._source}}","body":{"html":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}<a
        href=\"{{ctx.metadata.kibana_url}}/app/kibana#/discover?_a=(columns:!(_source),filters:!((''$state'':(store:appState),meta:(alias:!n,disabled:!f,index:''metricbeat-*'',key:query,negate:!f,type:custom,value:''''),query:(bool:(must:!((regexp:(kubernetes.pod.name:''{{ctx.metadata.regex}}'')),(match:(metricset.name:''state_pod'')),(match:(kubernetes.namespace:{{ctx.metadata.namespace}}))))))),index:''metricbeat-*'',interval:auto,query:(language:lucene,query:''''),regexp:(language:lucene,query:''kubernetes.pod.name:test-nginx-%5B%5E-%5D%20-%5B%5E-%5D%20''),sort:!(''@timestamp'',desc),time:(from:now%2FM,mode:quick,to:now%2FM))&_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-15m,mode:quick,to:now))\">{{ctx.metadata.name}}</a>
        has {{ctx.payload.aggregations.pods.value}} not ready pod(s) <a href=\"{{ctx.metadata.kibana_url}}/app/kibana#/management/elasticsearch/watcher/watches/watch/{{ctx.metadata.name}}\">[ack]</a>{{#ctx.metadata.docs}}
        <a href=\"{{.}}\">[docs]</a>{{/ctx.metadata.docs}}{{/ctx.payload.aggregations.result.hits.hits.0._source}}"}}},"notify-slack":{"throttle_period_in_millis":3600000,"slack":{"message":{"to":["@michael.russell"],"text":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}*<{{ctx.metadata.kibana_url}}/app/kibana#/discover?_a=(columns:!(_source),filters:!((''$state'':(store:appState),meta:(alias:!n,disabled:!f,index:''metricbeat-*'',key:query,negate:!f,type:custom,value:''''),query:(bool:(must:!((regexp:(kubernetes.pod.name:''{{ctx.metadata.regex}}'')),(match:(metricset.name:''state_pod'')),(match:(kubernetes.namespace:{{ctx.metadata.namespace}}))))))),index:''metricbeat-*'',interval:auto,query:(language:lucene,query:''''),regexp:(language:lucene,query:''kubernetes.pod.name:test-nginx-%5B%5E-%5D%20-%5B%5E-%5D%20''),sort:!(''@timestamp'',desc),time:(from:now%2FM,mode:quick,to:now%2FM))&_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-15m,mode:quick,to:now))|{{ctx.metadata.name}}>*
        has `{{ctx.payload.aggregations.pods.value}}` not ready pod(s) <{{ctx.metadata.kibana_url}}/app/kibana#/management/elasticsearch/watcher/watches/watch/{{ctx.metadata.name}}|[ack]>{{#ctx.metadata.docs}}
        <{{.}}|[docs]>{{/ctx.metadata.docs}}{{/ctx.payload.aggregations.result.hits.hits.0._source}}"}}}},"metadata":{"regex":"nginx-%5B%5E-%5D%2B-%5B%5E-%5D%2B","docs":"","name":"test.nginx","namespace":"test","window":"300s","kibana_url":"https://kibana.example.com","kibana_dashboard":"","xpack":{"type":"json"}},"status":{"state":{"active":true,"timestamp":"2019-03-15T15:26:53.390Z"},"actions":{"email_admin":{"ack":{"timestamp":"2019-03-15T15:26:53.390Z","state":"awaits_successful_execution"}},"notify-slack":{"ack":{"timestamp":"2019-03-15T15:26:53.390Z","state":"awaits_successful_execution"}}},"headers":{"_xpack_security_authentication":"w6XxAgAHZWxhc3RpYwEJc3VwZXJ1c2VyCgEJX3Jlc2VydmVkBQEAAAEAB3ZKWGJMRG4IcmVzZXJ2ZWQIcmVzZXJ2ZWQA"},"version":-1}}},{"_index":".watches","_type":"doc","_id":"test.hello","_score":1.0,"_source":{"trigger":{"schedule":{"interval":"30s"}},"input":{"search":{"request":{"search_type":"query_then_fetch","indices":["metricbeat-*"],"types":[],"body":{"aggs":{"result":{"top_hits":{"size":1}},"pods":{"cardinality":{"field":"kubernetes.pod.name"}},"not_ready":{"terms":{"field":"kubernetes.pod.name","min_doc_count":12,"size":100}}},"query":{"bool":{"must_not":[{"match":{"kubernetes.pod.status.phase":"running"}},{"match":{"kubernetes.pod.status.phase":"pending"}}],"must":[{"regexp":{"kubernetes.pod.name":"hello-[^-]+-[^-]+"}},{"match":{"kubernetes.namespace":"test"}},{"match":{"metricset.name":"state_pod"}}],"filter":[{"range":{"@timestamp":{"gte":"now-{{ctx.metadata.window}}"}}}]}},"size":2,"sort":[{"kubernetes.pod.name":{"order":"desc","mode":"max"}}]}}}},"condition":{"script":{"source":"for
        (h in ctx.payload.hits.hits) { if (h._source.kubernetes.pod.status.phase ==
        ''succeeded'') return false; } return true;","lang":"painless"}},"actions":{"email_admin":{"throttle_period_in_millis":3600000,"email":{"profile":"standard","to":["michael.russell@elastic.co"],"subject":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}{{ctx.metadata.name}}
        has {{ctx.payload.aggregations.pods.value}} not ready pod(s){{/ctx.payload.aggregations.result.hits.hits.0._source}}","body":{"html":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}<a
        href=\"{{ctx.metadata.kibana_url}}/app/kibana#/discover?_a=(columns:!(_source),filters:!((''$state'':(store:appState),meta:(alias:!n,disabled:!f,index:''metricbeat-*'',key:query,negate:!f,type:custom,value:''''),query:(bool:(must:!((regexp:(kubernetes.pod.name:''{{ctx.metadata.regex}}'')),(match:(metricset.name:''state_pod'')),(match:(kubernetes.namespace:{{ctx.metadata.namespace}}))))))),index:''metricbeat-*'',interval:auto,query:(language:lucene,query:''''),regexp:(language:lucene,query:''kubernetes.pod.name:test-nginx-%5B%5E-%5D%20-%5B%5E-%5D%20''),sort:!(''@timestamp'',desc),time:(from:now%2FM,mode:quick,to:now%2FM))&_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-15m,mode:quick,to:now))\">{{ctx.metadata.name}}</a>
        has {{ctx.payload.aggregations.pods.value}} not ready pod(s) <a href=\"{{ctx.metadata.kibana_url}}/app/kibana#/management/elasticsearch/watcher/watches/watch/{{ctx.metadata.name}}\">[ack]</a>{{#ctx.metadata.docs}}
        <a href=\"{{.}}\">[docs]</a>{{/ctx.metadata.docs}}{{/ctx.payload.aggregations.result.hits.hits.0._source}}"}}},"notify-slack":{"throttle_period_in_millis":3600000,"slack":{"message":{"to":["@michael.russell"],"text":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}*<{{ctx.metadata.kibana_url}}/app/kibana#/discover?_a=(columns:!(_source),filters:!((''$state'':(store:appState),meta:(alias:!n,disabled:!f,index:''metricbeat-*'',key:query,negate:!f,type:custom,value:''''),query:(bool:(must:!((regexp:(kubernetes.pod.name:''{{ctx.metadata.regex}}'')),(match:(metricset.name:''state_pod'')),(match:(kubernetes.namespace:{{ctx.metadata.namespace}}))))))),index:''metricbeat-*'',interval:auto,query:(language:lucene,query:''''),regexp:(language:lucene,query:''kubernetes.pod.name:test-nginx-%5B%5E-%5D%20-%5B%5E-%5D%20''),sort:!(''@timestamp'',desc),time:(from:now%2FM,mode:quick,to:now%2FM))&_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-15m,mode:quick,to:now))|{{ctx.metadata.name}}>*
        has `{{ctx.payload.aggregations.pods.value}}` not ready pod(s) <{{ctx.metadata.kibana_url}}/app/kibana#/management/elasticsearch/watcher/watches/watch/{{ctx.metadata.name}}|[ack]>{{#ctx.metadata.docs}}
        <{{.}}|[docs]>{{/ctx.metadata.docs}}{{/ctx.payload.aggregations.result.hits.hits.0._source}}"}}}},"metadata":{"regex":"hello-%5B%5E-%5D%2B-%5B%5E-%5D%2B","docs":"","name":"test.hello","namespace":"test","window":"300s","kibana_url":"https://kibana.example.com","kibana_dashboard":"","xpack":{"type":"json"}},"status":{"state":{"active":true,"timestamp":"2019-03-15T15:26:53.467Z"},"actions":{"email_admin":{"ack":{"timestamp":"2019-03-15T15:26:53.467Z","state":"awaits_successful_execution"}},"notify-slack":{"ack":{"timestamp":"2019-03-15T15:26:53.467Z","state":"awaits_successful_execution"}}},"headers":{"_xpack_security_authentication":"w6XxAgAHZWxhc3RpYwEJc3VwZXJ1c2VyCgEJX3Jlc2VydmVkBQEAAAEAB3ZKWGJMRG4IcmVzZXJ2ZWQIcmVzZXJ2ZWQA"},"version":-1}}},{"_index":".watches","_type":"doc","_id":"metricbeat","_score":1.0,"_source":{"trigger":{"schedule":{"interval":"60s"}},"input":{"search":{"request":{"search_type":"query_then_fetch","indices":["metricbeat-*"],"types":[],"body":{"query":{"bool":{"must":[{"match":{"metricset.name":"state_pod"}}],"filter":[{"range":{"@timestamp":{"gte":"now-{{ctx.metadata.window}}"}}}]}}}}}},"condition":{"compare":{"ctx.payload.hits.total":{"eq":0}}},"actions":{"email_admin":{"throttle_period_in_millis":3600000,"email":{"profile":"standard","to":["michael.russell@elastic.co"],"subject":"{{ctx.metadata.subject}}","body":{"text":"{{ctx.metadata.message}}"}}},"notify-slack":{"throttle_period_in_millis":3600000,"slack":{"message":{"to":["@michael.russell"],"text":"{{ctx.metadata.message}}"}}}},"metadata":{"subject":"No
        metricbeat data has been recieved in the last 5 minutes!","window":"300s","message":"No
        metricbeat data has been recieved in the last 5 minutes! <https://kibana.example.com|kibana>"},"status":{"state":{"active":true,"timestamp":"2019-03-15T15:26:53.554Z"},"actions":{"email_admin":{"ack":{"timestamp":"2019-03-15T15:26:53.554Z","state":"awaits_successful_execution"}},"notify-slack":{"ack":{"timestamp":"2019-03-15T15:26:53.554Z","state":"awaits_successful_execution"}}},"headers":{"_xpack_security_authentication":"w6XxAgAHZWxhc3RpYwEJc3VwZXJ1c2VyCgEJX3Jlc2VydmVkBQEAAAEAB3ZKWGJMRG4IcmVzZXJ2ZWQIcmVzZXJ2ZWQA"},"version":-1}}}]}}'
    headers:
      content-length:
      - '11269'
      content-type:
      - application/json; charset=UTF-8
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Content-Type:
      - application/json
      User-Agent:
      - Swagger-Codegen/8.0.1/python
    method: GET
    uri: https://192.168.39.133:8443/api/v1/namespaces?labelSelector=watcher%3Denabled
  response:
    body:
      string: '{"kind":"NamespaceList","apiVersion":"v1","metadata":{"selfLink":"/api/v1/namespaces","resourceVersion":"19382"},"items":[{"metadata":{"name":"override","selfLink":"/api/v1/namespaces/override","uid":"80297a53-4736-11e9-939b-48cec360726b","resourceVersion":"19125","creationTimestamp":"2019-03-15T15:25:01Z","labels":{"watcher":"enabled"},"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"Namespace\",\"metadata\":{\"annotations\":{\"watcher.alerts.slack\":\"@michael.override\"},\"labels\":{\"watcher\":\"enabled\"},\"name\":\"override\"}}\n","watcher.alerts.slack":"@michael.override"}},"spec":{"finalizers":["kubernetes"]},"status":{"phase":"Active"}},{"metadata":{"name":"test","selfLink":"/api/v1/namespaces/test","uid":"80446315-4736-11e9-939b-48cec360726b","resourceVersion":"19127","creationTimestamp":"2019-03-15T15:25:01Z","labels":{"watcher":"enabled"},"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"Namespace\",\"metadata\":{\"annotations\":{},\"labels\":{\"watcher\":\"enabled\"},\"name\":\"test\"}}\n"}},"spec":{"finalizers":["kubernetes"]},"status":{"phase":"Active"}}]}

        '
    headers:
      Content-Length:
      - '1191'
      Content-Type:
      - application/json
      Date:
      - Fri, 15 Mar 2019 15:26:56 GMT
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Content-Type:
      - application/json
      User-Agent:
      - Swagger-Codegen/8.0.1/python
    method: GET
    uri: https://192.168.39.133:8443/api/v1/pods?labelSelector=watcher%21%3Ddisabled&watch=False
  response:
    body:
      string: '{"kind":"PodList","apiVersion":"v1","metadata":{"selfLink":"/api/v1/pods","resourceVersion":"19382"},"items":[{"metadata":{"name":"disabled-85987979ff-5csqm","generateName":"disabled-85987979ff-","namespace":"disabled","selfLink":"/api/v1/namespaces/disabled/pods/disabled-85987979ff-5csqm","uid":"800f831d-4736-11e9-939b-48cec360726b","resourceVersion":"19234","creationTimestamp":"2019-03-15T15:25:01Z","labels":{"pod-template-hash":"85987979ff","run":"disabled"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"disabled-85987979ff","uid":"7feff794-4736-11e9-939b-48cec360726b","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"default-token-jsbmp","secret":{"secretName":"default-token-jsbmp","defaultMode":420}}],"containers":[{"name":"nginx","image":"nginx","resources":{},"volumeMounts":[{"name":"default-token-jsbmp","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"minikube","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:01Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:09Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:09Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:01Z"}],"hostIP":"192.168.122.33","podIP":"172.17.0.5","startTime":"2019-03-15T15:25:01Z","containerStatuses":[{"name":"nginx","state":{"running":{"startedAt":"2019-03-15T15:25:06Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"nginx:latest","imageID":"docker-pullable://nginx@sha256:98efe605f61725fd817ea69521b0eeb32bef007af0e3d0aeb6258c6e6fe7fc1a","containerID":"docker://c5c03d9d6b50e7d5cfebcdaab3b466c363d5f3e48ea9e647f6c8d1ae063e5a6d"}],"qosClass":"BestEffort"}},{"metadata":{"name":"nginx-5679fdf5c6-nmgh8","generateName":"nginx-5679fdf5c6-","namespace":"disabled","selfLink":"/api/v1/namespaces/disabled/pods/nginx-5679fdf5c6-nmgh8","uid":"80037fa7-4736-11e9-939b-48cec360726b","resourceVersion":"19216","creationTimestamp":"2019-03-15T15:25:01Z","labels":{"pod-template-hash":"5679fdf5c6","run":"nginx","watcher":"enabled"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"nginx-5679fdf5c6","uid":"7fe82db4-4736-11e9-939b-48cec360726b","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"default-token-jsbmp","secret":{"secretName":"default-token-jsbmp","defaultMode":420}}],"containers":[{"name":"nginx","image":"nginx","resources":{},"volumeMounts":[{"name":"default-token-jsbmp","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"minikube","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:01Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:07Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:07Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:01Z"}],"hostIP":"192.168.122.33","podIP":"172.17.0.4","startTime":"2019-03-15T15:25:01Z","containerStatuses":[{"name":"nginx","state":{"running":{"startedAt":"2019-03-15T15:25:06Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"nginx:latest","imageID":"docker-pullable://nginx@sha256:98efe605f61725fd817ea69521b0eeb32bef007af0e3d0aeb6258c6e6fe7fc1a","containerID":"docker://2ff0877484d6b943520128b80cc02f1d7e551a9811269c2f9165a3179a319ca6"}],"qosClass":"BestEffort"}},{"metadata":{"name":"coredns-86c58d9df4-5qdzj","generateName":"coredns-86c58d9df4-","namespace":"kube-system","selfLink":"/api/v1/namespaces/kube-system/pods/coredns-86c58d9df4-5qdzj","uid":"d6d7ac7e-471d-11e9-939b-48cec360726b","resourceVersion":"369","creationTimestamp":"2019-03-15T12:28:29Z","labels":{"k8s-app":"kube-dns","pod-template-hash":"86c58d9df4"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"coredns-86c58d9df4","uid":"d6ce66e0-471d-11e9-939b-48cec360726b","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"config-volume","configMap":{"name":"coredns","items":[{"key":"Corefile","path":"Corefile"}],"defaultMode":420}},{"name":"coredns-token-ftd8b","secret":{"secretName":"coredns-token-ftd8b","defaultMode":420}}],"containers":[{"name":"coredns","image":"k8s.gcr.io/coredns:1.2.6","args":["-conf","/etc/coredns/Corefile"],"ports":[{"name":"dns","containerPort":53,"protocol":"UDP"},{"name":"dns-tcp","containerPort":53,"protocol":"TCP"},{"name":"metrics","containerPort":9153,"protocol":"TCP"}],"resources":{"limits":{"memory":"170Mi"},"requests":{"cpu":"100m","memory":"70Mi"}},"volumeMounts":[{"name":"config-volume","readOnly":true,"mountPath":"/etc/coredns"},{"name":"coredns-token-ftd8b","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"livenessProbe":{"httpGet":{"path":"/health","port":8080,"scheme":"HTTP"},"initialDelaySeconds":60,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":5},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"add":["NET_BIND_SERVICE"],"drop":["all"]},"readOnlyRootFilesystem":true,"allowPrivilegeEscalation":false,"procMount":"Default"}}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"Default","serviceAccountName":"coredns","serviceAccount":"coredns","nodeName":"minikube","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"CriticalAddonsOnly","operator":"Exists"},{"key":"node-role.kubernetes.io/master","effect":"NoSchedule"},{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:29Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:31Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:31Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:29Z"}],"hostIP":"192.168.122.33","podIP":"172.17.0.2","startTime":"2019-03-15T12:28:29Z","containerStatuses":[{"name":"coredns","state":{"running":{"startedAt":"2019-03-15T12:28:30Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"k8s.gcr.io/coredns:1.2.6","imageID":"docker-pullable://k8s.gcr.io/coredns@sha256:81936728011c0df9404cb70b95c17bbc8af922ec9a70d0561a5d01fefa6ffa51","containerID":"docker://cc5a4b7ac41d0e81be2f8668ff7590b028764011517b652f5fe81f5026216a1d"}],"qosClass":"Burstable"}},{"metadata":{"name":"coredns-86c58d9df4-m4zj9","generateName":"coredns-86c58d9df4-","namespace":"kube-system","selfLink":"/api/v1/namespaces/kube-system/pods/coredns-86c58d9df4-m4zj9","uid":"d6d91114-471d-11e9-939b-48cec360726b","resourceVersion":"377","creationTimestamp":"2019-03-15T12:28:29Z","labels":{"k8s-app":"kube-dns","pod-template-hash":"86c58d9df4"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"coredns-86c58d9df4","uid":"d6ce66e0-471d-11e9-939b-48cec360726b","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"config-volume","configMap":{"name":"coredns","items":[{"key":"Corefile","path":"Corefile"}],"defaultMode":420}},{"name":"coredns-token-ftd8b","secret":{"secretName":"coredns-token-ftd8b","defaultMode":420}}],"containers":[{"name":"coredns","image":"k8s.gcr.io/coredns:1.2.6","args":["-conf","/etc/coredns/Corefile"],"ports":[{"name":"dns","containerPort":53,"protocol":"UDP"},{"name":"dns-tcp","containerPort":53,"protocol":"TCP"},{"name":"metrics","containerPort":9153,"protocol":"TCP"}],"resources":{"limits":{"memory":"170Mi"},"requests":{"cpu":"100m","memory":"70Mi"}},"volumeMounts":[{"name":"config-volume","readOnly":true,"mountPath":"/etc/coredns"},{"name":"coredns-token-ftd8b","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"livenessProbe":{"httpGet":{"path":"/health","port":8080,"scheme":"HTTP"},"initialDelaySeconds":60,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":5},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"add":["NET_BIND_SERVICE"],"drop":["all"]},"readOnlyRootFilesystem":true,"allowPrivilegeEscalation":false,"procMount":"Default"}}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"Default","serviceAccountName":"coredns","serviceAccount":"coredns","nodeName":"minikube","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"CriticalAddonsOnly","operator":"Exists"},{"key":"node-role.kubernetes.io/master","effect":"NoSchedule"},{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:29Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:31Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:31Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:29Z"}],"hostIP":"192.168.122.33","podIP":"172.17.0.3","startTime":"2019-03-15T12:28:29Z","containerStatuses":[{"name":"coredns","state":{"running":{"startedAt":"2019-03-15T12:28:31Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"k8s.gcr.io/coredns:1.2.6","imageID":"docker-pullable://k8s.gcr.io/coredns@sha256:81936728011c0df9404cb70b95c17bbc8af922ec9a70d0561a5d01fefa6ffa51","containerID":"docker://906b986dfd9b8fe7f51a20f882da73bd4741372c93fd3a2b1e9140d0379230ae"}],"qosClass":"Burstable"}},{"metadata":{"name":"etcd-minikube","namespace":"kube-system","selfLink":"/api/v1/namespaces/kube-system/pods/etcd-minikube","uid":"ec8b0aed-471d-11e9-939b-48cec360726b","resourceVersion":"437","creationTimestamp":"2019-03-15T12:29:05Z","labels":{"component":"etcd","tier":"control-plane"},"annotations":{"kubernetes.io/config.hash":"f458e372dcbd3f6a2660edb486489a0f","kubernetes.io/config.mirror":"f458e372dcbd3f6a2660edb486489a0f","kubernetes.io/config.seen":"2019-03-15T12:28:00.927928535Z","kubernetes.io/config.source":"file","scheduler.alpha.kubernetes.io/critical-pod":""}},"spec":{"volumes":[{"name":"etcd-certs","hostPath":{"path":"/var/lib/minikube/certs//etcd","type":"DirectoryOrCreate"}},{"name":"etcd-data","hostPath":{"path":"/data/minikube","type":"DirectoryOrCreate"}}],"containers":[{"name":"etcd","image":"k8s.gcr.io/etcd:3.2.24","command":["etcd","--advertise-client-urls=https://192.168.39.133:2379","--cert-file=/var/lib/minikube/certs/etcd/server.crt","--client-cert-auth=true","--data-dir=/data/minikube","--initial-advertise-peer-urls=https://192.168.39.133:2380","--initial-cluster=minikube=https://192.168.39.133:2380","--key-file=/var/lib/minikube/certs/etcd/server.key","--listen-client-urls=https://127.0.0.1:2379,https://192.168.39.133:2379","--listen-peer-urls=https://192.168.39.133:2380","--name=minikube","--peer-cert-file=/var/lib/minikube/certs/etcd/peer.crt","--peer-client-cert-auth=true","--peer-key-file=/var/lib/minikube/certs/etcd/peer.key","--peer-trusted-ca-file=/var/lib/minikube/certs/etcd/ca.crt","--snapshot-count=10000","--trusted-ca-file=/var/lib/minikube/certs/etcd/ca.crt"],"resources":{},"volumeMounts":[{"name":"etcd-data","mountPath":"/data/minikube"},{"name":"etcd-certs","mountPath":"/var/lib/minikube/certs//etcd"}],"livenessProbe":{"exec":{"command":["/bin/sh","-ec","ETCDCTL_API=3
        etcdctl --endpoints=https://[127.0.0.1]:2379 --cacert=/var/lib/minikube/certs//etcd/ca.crt
        --cert=/var/lib/minikube/certs//etcd/healthcheck-client.crt --key=/var/lib/minikube/certs//etcd/healthcheck-client.key
        get foo"]},"initialDelaySeconds":15,"timeoutSeconds":15,"periodSeconds":10,"successThreshold":1,"failureThreshold":8},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","nodeName":"minikube","hostNetwork":true,"securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"operator":"Exists","effect":"NoExecute"}],"priorityClassName":"system-cluster-critical","priority":2000000000,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:01Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:04Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:04Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:01Z"}],"hostIP":"192.168.122.33","podIP":"192.168.122.33","startTime":"2019-03-15T12:28:01Z","containerStatuses":[{"name":"etcd","state":{"running":{"startedAt":"2019-03-15T12:28:03Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"k8s.gcr.io/etcd:3.2.24","imageID":"docker-pullable://k8s.gcr.io/etcd@sha256:905d7ca17fd02bc24c0eba9a062753aba15db3e31422390bc3238eb762339b20","containerID":"docker://5b217a5029c7d756d5ec92b2fe3037a7478a1aa74701ca54da1e569148cfa0a9"}],"qosClass":"BestEffort"}},{"metadata":{"name":"kube-addon-manager-minikube","namespace":"kube-system","selfLink":"/api/v1/namespaces/kube-system/pods/kube-addon-manager-minikube","uid":"fad70dc0-471d-11e9-939b-48cec360726b","resourceVersion":"467","creationTimestamp":"2019-03-15T12:29:29Z","labels":{"component":"kube-addon-manager","kubernetes.io/minikube-addons":"addon-manager","version":"v8.6"},"annotations":{"kubernetes.io/config.hash":"5c72fb06dcdda608211b70d63c0ca488","kubernetes.io/config.mirror":"5c72fb06dcdda608211b70d63c0ca488","kubernetes.io/config.seen":"2019-03-15T12:28:00.927923947Z","kubernetes.io/config.source":"file"}},"spec":{"volumes":[{"name":"addons","hostPath":{"path":"/etc/kubernetes/","type":""}},{"name":"kubeconfig","hostPath":{"path":"/var/lib/minikube/","type":""}}],"containers":[{"name":"kube-addon-manager","image":"k8s.gcr.io/kube-addon-manager:v8.6","env":[{"name":"KUBECONFIG","value":"/var/lib/minikube/kubeconfig"}],"resources":{"requests":{"cpu":"5m","memory":"50Mi"}},"volumeMounts":[{"name":"addons","readOnly":true,"mountPath":"/etc/kubernetes/"},{"name":"kubeconfig","readOnly":true,"mountPath":"/var/lib/minikube/"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","nodeName":"minikube","hostNetwork":true,"securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"operator":"Exists","effect":"NoExecute"}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:01Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:08Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:08Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:01Z"}],"hostIP":"192.168.122.33","podIP":"192.168.122.33","startTime":"2019-03-15T12:28:01Z","containerStatuses":[{"name":"kube-addon-manager","state":{"running":{"startedAt":"2019-03-15T12:28:08Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"k8s.gcr.io/kube-addon-manager:v8.6","imageID":"docker-pullable://k8s.gcr.io/kube-addon-manager@sha256:3519273916ba45cfc9b318448d4629819cb5fbccbb0822cce054dd8c1f68cb60","containerID":"docker://74dc4c2f634c9bdd45d5630913c6fe1ba60cb740f4a69542dc9d70ccc483446c"}],"qosClass":"Burstable"}},{"metadata":{"name":"kube-apiserver-minikube","namespace":"kube-system","selfLink":"/api/v1/namespaces/kube-system/pods/kube-apiserver-minikube","uid":"f14decaf-471d-11e9-939b-48cec360726b","resourceVersion":"452","creationTimestamp":"2019-03-15T12:29:13Z","labels":{"component":"kube-apiserver","tier":"control-plane"},"annotations":{"kubernetes.io/config.hash":"cff814453293d88353a4f2122c8071ff","kubernetes.io/config.mirror":"cff814453293d88353a4f2122c8071ff","kubernetes.io/config.seen":"2019-03-15T12:28:00.927930238Z","kubernetes.io/config.source":"file","scheduler.alpha.kubernetes.io/critical-pod":""}},"spec":{"volumes":[{"name":"ca-certs","hostPath":{"path":"/etc/ssl/certs","type":"DirectoryOrCreate"}},{"name":"k8s-certs","hostPath":{"path":"/var/lib/minikube/certs/","type":"DirectoryOrCreate"}},{"name":"usr-share-ca-certificates","hostPath":{"path":"/usr/share/ca-certificates","type":"DirectoryOrCreate"}}],"containers":[{"name":"kube-apiserver","image":"k8s.gcr.io/kube-apiserver:v1.13.4","command":["kube-apiserver","--authorization-mode=Node,RBAC","--enable-admission-plugins=Initializers,NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,NodeRestriction,MutatingAdmissionWebhook,ValidatingAdmissionWebhook,ResourceQuota","--advertise-address=192.168.39.133","--allow-privileged=true","--client-ca-file=/var/lib/minikube/certs/ca.crt","--enable-bootstrap-token-auth=true","--etcd-cafile=/var/lib/minikube/certs/etcd/ca.crt","--etcd-certfile=/var/lib/minikube/certs/apiserver-etcd-client.crt","--etcd-keyfile=/var/lib/minikube/certs/apiserver-etcd-client.key","--etcd-servers=https://127.0.0.1:2379","--insecure-port=0","--kubelet-client-certificate=/var/lib/minikube/certs/apiserver-kubelet-client.crt","--kubelet-client-key=/var/lib/minikube/certs/apiserver-kubelet-client.key","--kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname","--proxy-client-cert-file=/var/lib/minikube/certs/front-proxy-client.crt","--proxy-client-key-file=/var/lib/minikube/certs/front-proxy-client.key","--requestheader-allowed-names=front-proxy-client","--requestheader-client-ca-file=/var/lib/minikube/certs/front-proxy-ca.crt","--requestheader-extra-headers-prefix=X-Remote-Extra-","--requestheader-group-headers=X-Remote-Group","--requestheader-username-headers=X-Remote-User","--secure-port=8443","--service-account-key-file=/var/lib/minikube/certs/sa.pub","--service-cluster-ip-range=10.96.0.0/12","--tls-cert-file=/var/lib/minikube/certs/apiserver.crt","--tls-private-key-file=/var/lib/minikube/certs/apiserver.key"],"resources":{"requests":{"cpu":"250m"}},"volumeMounts":[{"name":"ca-certs","readOnly":true,"mountPath":"/etc/ssl/certs"},{"name":"k8s-certs","readOnly":true,"mountPath":"/var/lib/minikube/certs/"},{"name":"usr-share-ca-certificates","readOnly":true,"mountPath":"/usr/share/ca-certificates"}],"livenessProbe":{"httpGet":{"path":"/healthz","port":8443,"host":"192.168.39.133","scheme":"HTTPS"},"initialDelaySeconds":15,"timeoutSeconds":15,"periodSeconds":10,"successThreshold":1,"failureThreshold":8},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","nodeName":"minikube","hostNetwork":true,"securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"operator":"Exists","effect":"NoExecute"}],"priorityClassName":"system-cluster-critical","priority":2000000000,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:01Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:04Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:04Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:01Z"}],"hostIP":"192.168.122.33","podIP":"192.168.122.33","startTime":"2019-03-15T12:28:01Z","containerStatuses":[{"name":"kube-apiserver","state":{"running":{"startedAt":"2019-03-15T12:28:03Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"k8s.gcr.io/kube-apiserver:v1.13.4","imageID":"docker-pullable://k8s.gcr.io/kube-apiserver@sha256:9f3c39082ceea4979edabf1c981a54c0b3e32da5243c242beffa556241e81ae5","containerID":"docker://9cb5e5e317d1dfcdf1ded78c4acce4e90743175645e24c5c8c62f9088501b170"}],"qosClass":"Burstable"}},{"metadata":{"name":"kube-controller-manager-minikube","namespace":"kube-system","selfLink":"/api/v1/namespaces/kube-system/pods/kube-controller-manager-minikube","uid":"fdd39eea-471d-11e9-939b-48cec360726b","resourceVersion":"482","creationTimestamp":"2019-03-15T12:29:34Z","labels":{"component":"kube-controller-manager","tier":"control-plane"},"annotations":{"kubernetes.io/config.hash":"17eea6fd9342634d7d40a04d577641fd","kubernetes.io/config.mirror":"17eea6fd9342634d7d40a04d577641fd","kubernetes.io/config.seen":"2019-03-15T12:28:00.927931635Z","kubernetes.io/config.source":"file","scheduler.alpha.kubernetes.io/critical-pod":""}},"spec":{"volumes":[{"name":"ca-certs","hostPath":{"path":"/etc/ssl/certs","type":"DirectoryOrCreate"}},{"name":"k8s-certs","hostPath":{"path":"/var/lib/minikube/certs/","type":"DirectoryOrCreate"}},{"name":"kubeconfig","hostPath":{"path":"/etc/kubernetes/controller-manager.conf","type":"FileOrCreate"}},{"name":"usr-share-ca-certificates","hostPath":{"path":"/usr/share/ca-certificates","type":"DirectoryOrCreate"}}],"containers":[{"name":"kube-controller-manager","image":"k8s.gcr.io/kube-controller-manager:v1.13.4","command":["kube-controller-manager","--address=127.0.0.1","--authentication-kubeconfig=/etc/kubernetes/controller-manager.conf","--authorization-kubeconfig=/etc/kubernetes/controller-manager.conf","--client-ca-file=/var/lib/minikube/certs/ca.crt","--cluster-signing-cert-file=/var/lib/minikube/certs/ca.crt","--cluster-signing-key-file=/var/lib/minikube/certs/ca.key","--controllers=*,bootstrapsigner,tokencleaner","--kubeconfig=/etc/kubernetes/controller-manager.conf","--leader-elect=true","--requestheader-client-ca-file=/var/lib/minikube/certs/front-proxy-ca.crt","--root-ca-file=/var/lib/minikube/certs/ca.crt","--service-account-private-key-file=/var/lib/minikube/certs/sa.key","--use-service-account-credentials=true"],"resources":{"requests":{"cpu":"200m"}},"volumeMounts":[{"name":"ca-certs","readOnly":true,"mountPath":"/etc/ssl/certs"},{"name":"k8s-certs","readOnly":true,"mountPath":"/var/lib/minikube/certs/"},{"name":"kubeconfig","readOnly":true,"mountPath":"/etc/kubernetes/controller-manager.conf"},{"name":"usr-share-ca-certificates","readOnly":true,"mountPath":"/usr/share/ca-certificates"}],"livenessProbe":{"httpGet":{"path":"/healthz","port":10252,"host":"127.0.0.1","scheme":"HTTP"},"initialDelaySeconds":15,"timeoutSeconds":15,"periodSeconds":10,"successThreshold":1,"failureThreshold":8},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","nodeName":"minikube","hostNetwork":true,"securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"operator":"Exists","effect":"NoExecute"}],"priorityClassName":"system-cluster-critical","priority":2000000000,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:01Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:04Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:04Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:01Z"}],"hostIP":"192.168.122.33","podIP":"192.168.122.33","startTime":"2019-03-15T12:28:01Z","containerStatuses":[{"name":"kube-controller-manager","state":{"running":{"startedAt":"2019-03-15T12:28:03Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"k8s.gcr.io/kube-controller-manager:v1.13.4","imageID":"docker-pullable://k8s.gcr.io/kube-controller-manager@sha256:84477c0a8d0f8db87f12856d7b97c2784856caf3bc46bc9dd73f5ac219bc9d06","containerID":"docker://2049b9bf8f8d311952240cb8ce7a4dfcf4451511607bffcad6f36f1fb7c06ea1"}],"qosClass":"Burstable"}},{"metadata":{"name":"kube-proxy-2brt2","generateName":"kube-proxy-","namespace":"kube-system","selfLink":"/api/v1/namespaces/kube-system/pods/kube-proxy-2brt2","uid":"d6eb7db0-471d-11e9-939b-48cec360726b","resourceVersion":"375","creationTimestamp":"2019-03-15T12:28:29Z","labels":{"controller-revision-hash":"7f85dc994","k8s-app":"kube-proxy","pod-template-generation":"1"},"annotations":{"scheduler.alpha.kubernetes.io/critical-pod":""},"ownerReferences":[{"apiVersion":"apps/v1","kind":"DaemonSet","name":"kube-proxy","uid":"d37d3598-471d-11e9-939b-48cec360726b","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"kube-proxy","configMap":{"name":"kube-proxy","defaultMode":420}},{"name":"xtables-lock","hostPath":{"path":"/run/xtables.lock","type":"FileOrCreate"}},{"name":"lib-modules","hostPath":{"path":"/lib/modules","type":""}},{"name":"kube-proxy-token-p964s","secret":{"secretName":"kube-proxy-token-p964s","defaultMode":420}}],"containers":[{"name":"kube-proxy","image":"k8s.gcr.io/kube-proxy:v1.13.4","command":["/usr/local/bin/kube-proxy","--config=/var/lib/kube-proxy/config.conf","--hostname-override=$(NODE_NAME)"],"env":[{"name":"NODE_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"spec.nodeName"}}}],"resources":{},"volumeMounts":[{"name":"kube-proxy","mountPath":"/var/lib/kube-proxy"},{"name":"xtables-lock","mountPath":"/run/xtables.lock"},{"name":"lib-modules","readOnly":true,"mountPath":"/lib/modules"},{"name":"kube-proxy-token-p964s","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"privileged":true,"procMount":"Default"}}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"kube-proxy","serviceAccount":"kube-proxy","nodeName":"minikube","hostNetwork":true,"securityContext":{},"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchFields":[{"key":"metadata.name","operator":"In","values":["minikube"]}]}]}}},"schedulerName":"default-scheduler","tolerations":[{"key":"CriticalAddonsOnly","operator":"Exists"},{"operator":"Exists"},{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute"},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute"},{"key":"node.kubernetes.io/disk-pressure","operator":"Exists","effect":"NoSchedule"},{"key":"node.kubernetes.io/memory-pressure","operator":"Exists","effect":"NoSchedule"},{"key":"node.kubernetes.io/unschedulable","operator":"Exists","effect":"NoSchedule"},{"key":"node.kubernetes.io/network-unavailable","operator":"Exists","effect":"NoSchedule"}],"priorityClassName":"system-node-critical","priority":2000001000,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:29Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:31Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:31Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:29Z"}],"hostIP":"192.168.122.33","podIP":"192.168.122.33","startTime":"2019-03-15T12:28:29Z","containerStatuses":[{"name":"kube-proxy","state":{"running":{"startedAt":"2019-03-15T12:28:31Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"k8s.gcr.io/kube-proxy:v1.13.4","imageID":"docker-pullable://k8s.gcr.io/kube-proxy@sha256:e57fd7593e2bdc161e41b8922e5fba6dbdab790608fc8671721eb26fbabd3090","containerID":"docker://b5c6591817f167594c59da1e5ded5528270adbfc33a6603249c7b3c142bbf703"}],"qosClass":"BestEffort"}},{"metadata":{"name":"kube-scheduler-minikube","namespace":"kube-system","selfLink":"/api/v1/namespaces/kube-system/pods/kube-scheduler-minikube","uid":"f3b11fc2-471d-11e9-939b-48cec360726b","resourceVersion":"453","creationTimestamp":"2019-03-15T12:29:17Z","labels":{"component":"kube-scheduler","tier":"control-plane"},"annotations":{"kubernetes.io/config.hash":"4b52d75cab61380f07c0c5a69fb371d4","kubernetes.io/config.mirror":"4b52d75cab61380f07c0c5a69fb371d4","kubernetes.io/config.seen":"2019-03-15T12:28:00.927932928Z","kubernetes.io/config.source":"file","scheduler.alpha.kubernetes.io/critical-pod":""}},"spec":{"volumes":[{"name":"kubeconfig","hostPath":{"path":"/etc/kubernetes/scheduler.conf","type":"FileOrCreate"}}],"containers":[{"name":"kube-scheduler","image":"k8s.gcr.io/kube-scheduler:v1.13.4","command":["kube-scheduler","--address=127.0.0.1","--kubeconfig=/etc/kubernetes/scheduler.conf","--leader-elect=true"],"resources":{"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kubeconfig","readOnly":true,"mountPath":"/etc/kubernetes/scheduler.conf"}],"livenessProbe":{"httpGet":{"path":"/healthz","port":10251,"host":"127.0.0.1","scheme":"HTTP"},"initialDelaySeconds":15,"timeoutSeconds":15,"periodSeconds":10,"successThreshold":1,"failureThreshold":8},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","nodeName":"minikube","hostNetwork":true,"securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"operator":"Exists","effect":"NoExecute"}],"priorityClassName":"system-cluster-critical","priority":2000000000,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:01Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:04Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:04Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:01Z"}],"hostIP":"192.168.122.33","podIP":"192.168.122.33","startTime":"2019-03-15T12:28:01Z","containerStatuses":[{"name":"kube-scheduler","state":{"running":{"startedAt":"2019-03-15T12:28:03Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"k8s.gcr.io/kube-scheduler:v1.13.4","imageID":"docker-pullable://k8s.gcr.io/kube-scheduler@sha256:e7b2f9b1dcfa03b0e43b891979075d62086fe14e169de081f9c23db378f5b2f7","containerID":"docker://f389dc9fd101bd5d5a9436789338892f8630ba9fd22c7c5f058e9b844606fca9"}],"qosClass":"Burstable"}},{"metadata":{"name":"metricbeat-79fc7dc96f-mw95v","generateName":"metricbeat-79fc7dc96f-","namespace":"kube-system","selfLink":"/api/v1/namespaces/kube-system/pods/metricbeat-79fc7dc96f-mw95v","uid":"82e465b0-4736-11e9-939b-48cec360726b","resourceVersion":"19231","creationTimestamp":"2019-03-15T15:25:06Z","labels":{"k8s-app":"metricbeat","pod-template-hash":"79fc7dc96f"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"metricbeat-79fc7dc96f","uid":"82036c99-4736-11e9-939b-48cec360726b","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"config","configMap":{"name":"metricbeat-deployment-config","defaultMode":384}},{"name":"modules","configMap":{"name":"metricbeat-deployment-modules","defaultMode":384}},{"name":"metricbeat-token-c4wqb","secret":{"secretName":"metricbeat-token-c4wqb","defaultMode":420}}],"containers":[{"name":"metricbeat","image":"docker.elastic.co/beats/metricbeat:6.5.3","args":["-c","/etc/metricbeat.yml","-e"],"env":[{"name":"ELASTICSEARCH_HOST","value":"elasticsearch"},{"name":"ELASTICSEARCH_PORT","value":"9200"},{"name":"ELASTICSEARCH_USERNAME","value":"elastic"},{"name":"ELASTICSEARCH_PASSWORD","value":"changeme"},{"name":"ELASTIC_CLOUD_ID"},{"name":"ELASTIC_CLOUD_AUTH"},{"name":"NODE_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"spec.nodeName"}}}],"resources":{"limits":{"memory":"200Mi"},"requests":{"cpu":"100m","memory":"100Mi"}},"volumeMounts":[{"name":"config","readOnly":true,"mountPath":"/etc/metricbeat.yml","subPath":"metricbeat.yml"},{"name":"modules","readOnly":true,"mountPath":"/usr/share/metricbeat/modules.d"},{"name":"metricbeat-token-c4wqb","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"runAsUser":0,"procMount":"Default"}}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirstWithHostNet","serviceAccountName":"metricbeat","serviceAccount":"metricbeat","nodeName":"minikube","hostNetwork":true,"securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:06Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:09Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:09Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:06Z"}],"hostIP":"192.168.122.33","podIP":"192.168.122.33","startTime":"2019-03-15T15:25:06Z","containerStatuses":[{"name":"metricbeat","state":{"running":{"startedAt":"2019-03-15T15:25:09Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"docker.elastic.co/beats/metricbeat:6.5.3","imageID":"docker-pullable://docker.elastic.co/beats/metricbeat@sha256:3e56944549f8656933d75e69248e02c585f1a30ef540023e8654e2caddd21210","containerID":"docker://207fa2407a4a3d97e6109067bdc27f4fc33f5dd9ddfbbea7968556d0c478c8da"}],"qosClass":"Burstable"}},{"metadata":{"name":"metricbeat-bstss","generateName":"metricbeat-","namespace":"kube-system","selfLink":"/api/v1/namespaces/kube-system/pods/metricbeat-bstss","uid":"82e3fe8b-4736-11e9-939b-48cec360726b","resourceVersion":"19238","creationTimestamp":"2019-03-15T15:25:06Z","labels":{"controller-revision-hash":"5667558677","k8s-app":"metricbeat","pod-template-generation":"1"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"DaemonSet","name":"metricbeat","uid":"81c7f6ee-4736-11e9-939b-48cec360726b","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"proc","hostPath":{"path":"/proc","type":""}},{"name":"cgroup","hostPath":{"path":"/sys/fs/cgroup","type":""}},{"name":"dockersock","hostPath":{"path":"/var/run/docker.sock","type":""}},{"name":"config","configMap":{"name":"metricbeat-daemonset-config","defaultMode":384}},{"name":"modules","configMap":{"name":"metricbeat-daemonset-modules","defaultMode":384}},{"name":"data","hostPath":{"path":"/var/lib/metricbeat-data","type":"DirectoryOrCreate"}},{"name":"metricbeat-token-c4wqb","secret":{"secretName":"metricbeat-token-c4wqb","defaultMode":420}}],"containers":[{"name":"metricbeat","image":"docker.elastic.co/beats/metricbeat:6.5.3","args":["-c","/etc/metricbeat.yml","-e","-system.hostfs=/hostfs"],"env":[{"name":"ELASTICSEARCH_HOST","value":"elasticsearch"},{"name":"ELASTICSEARCH_PORT","value":"9200"},{"name":"ELASTICSEARCH_USERNAME","value":"elastic"},{"name":"ELASTICSEARCH_PASSWORD","value":"changeme"},{"name":"ELASTIC_CLOUD_ID"},{"name":"ELASTIC_CLOUD_AUTH"},{"name":"NODE_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"spec.nodeName"}}}],"resources":{"limits":{"memory":"200Mi"},"requests":{"cpu":"100m","memory":"100Mi"}},"volumeMounts":[{"name":"config","readOnly":true,"mountPath":"/etc/metricbeat.yml","subPath":"metricbeat.yml"},{"name":"modules","readOnly":true,"mountPath":"/usr/share/metricbeat/modules.d"},{"name":"dockersock","mountPath":"/var/run/docker.sock"},{"name":"proc","readOnly":true,"mountPath":"/hostfs/proc"},{"name":"cgroup","readOnly":true,"mountPath":"/hostfs/sys/fs/cgroup"},{"name":"metricbeat-token-c4wqb","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"runAsUser":0,"procMount":"Default"}}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirstWithHostNet","serviceAccountName":"metricbeat","serviceAccount":"metricbeat","nodeName":"minikube","hostNetwork":true,"securityContext":{},"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchFields":[{"key":"metadata.name","operator":"In","values":["minikube"]}]}]}}},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute"},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute"},{"key":"node.kubernetes.io/disk-pressure","operator":"Exists","effect":"NoSchedule"},{"key":"node.kubernetes.io/memory-pressure","operator":"Exists","effect":"NoSchedule"},{"key":"node.kubernetes.io/unschedulable","operator":"Exists","effect":"NoSchedule"},{"key":"node.kubernetes.io/network-unavailable","operator":"Exists","effect":"NoSchedule"}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:06Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:09Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:09Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:06Z"}],"hostIP":"192.168.122.33","podIP":"192.168.122.33","startTime":"2019-03-15T15:25:06Z","containerStatuses":[{"name":"metricbeat","state":{"running":{"startedAt":"2019-03-15T15:25:08Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"docker.elastic.co/beats/metricbeat:6.5.3","imageID":"docker-pullable://docker.elastic.co/beats/metricbeat@sha256:3e56944549f8656933d75e69248e02c585f1a30ef540023e8654e2caddd21210","containerID":"docker://d0792e5ff270acc12cde4f9d45fee1ffaa3e7edfa54b6cbf949bdc282716d168"}],"qosClass":"Burstable"}},{"metadata":{"name":"registry-creds-7gttm","generateName":"registry-creds-","namespace":"kube-system","selfLink":"/api/v1/namespaces/kube-system/pods/registry-creds-7gttm","uid":"d7e3d71a-471d-11e9-939b-48cec360726b","resourceVersion":"360","creationTimestamp":"2019-03-15T12:28:31Z","labels":{"addonmanager.kubernetes.io/mode":"Reconcile","name":"registry-creds","version":"v1.9"},"ownerReferences":[{"apiVersion":"v1","kind":"ReplicationController","name":"registry-creds","uid":"d7e327d1-471d-11e9-939b-48cec360726b","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"gcr-creds","secret":{"secretName":"registry-creds-gcr","items":[{"key":"application_default_credentials.json","path":"application_default_credentials.json"}],"defaultMode":420}},{"name":"default-token-ctdr6","secret":{"secretName":"default-token-ctdr6","defaultMode":420}}],"containers":[{"name":"registry-creds","image":"registry.hub.docker.com/upmcenterprises/registry-creds:1.9","env":[{"name":"AWS_ACCESS_KEY_ID","valueFrom":{"secretKeyRef":{"name":"registry-creds-ecr","key":"AWS_ACCESS_KEY_ID"}}},{"name":"AWS_SECRET_ACCESS_KEY","valueFrom":{"secretKeyRef":{"name":"registry-creds-ecr","key":"AWS_SECRET_ACCESS_KEY"}}},{"name":"AWS_SESSION_TOKEN","valueFrom":{"secretKeyRef":{"name":"registry-creds-ecr","key":"AWS_SESSION_TOKEN"}}},{"name":"awsregion","valueFrom":{"secretKeyRef":{"name":"registry-creds-ecr","key":"aws-region"}}},{"name":"awsaccount","valueFrom":{"secretKeyRef":{"name":"registry-creds-ecr","key":"aws-account"}}},{"name":"aws_assume_role","valueFrom":{"secretKeyRef":{"name":"registry-creds-ecr","key":"aws-assume-role"}}},{"name":"awsregion","valueFrom":{"secretKeyRef":{"name":"registry-creds-ecr","key":"aws-region"}}},{"name":"DOCKER_PRIVATE_REGISTRY_PASSWORD","valueFrom":{"secretKeyRef":{"name":"registry-creds-dpr","key":"DOCKER_PRIVATE_REGISTRY_PASSWORD"}}},{"name":"DOCKER_PRIVATE_REGISTRY_SERVER","valueFrom":{"secretKeyRef":{"name":"registry-creds-dpr","key":"DOCKER_PRIVATE_REGISTRY_SERVER"}}},{"name":"DOCKER_PRIVATE_REGISTRY_USER","valueFrom":{"secretKeyRef":{"name":"registry-creds-dpr","key":"DOCKER_PRIVATE_REGISTRY_USER"}}},{"name":"gcrurl","valueFrom":{"secretKeyRef":{"name":"registry-creds-gcr","key":"gcrurl"}}}],"resources":{},"volumeMounts":[{"name":"gcr-creds","readOnly":true,"mountPath":"/root/.config/gcloud"},{"name":"default-token-ctdr6","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"minikube","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Pending","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:31Z"},{"type":"Ready","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:31Z","reason":"ContainersNotReady","message":"containers
        with unready status: [registry-creds]"},{"type":"ContainersReady","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:31Z","reason":"ContainersNotReady","message":"containers
        with unready status: [registry-creds]"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:31Z"}],"hostIP":"192.168.122.33","startTime":"2019-03-15T12:28:31Z","containerStatuses":[{"name":"registry-creds","state":{"waiting":{"reason":"ContainerCreating"}},"lastState":{},"ready":false,"restartCount":0,"image":"registry.hub.docker.com/upmcenterprises/registry-creds:1.9","imageID":""}],"qosClass":"BestEffort"}},{"metadata":{"name":"storage-provisioner","namespace":"kube-system","selfLink":"/api/v1/namespaces/kube-system/pods/storage-provisioner","uid":"d7ebef80-471d-11e9-939b-48cec360726b","resourceVersion":"392","creationTimestamp":"2019-03-15T12:28:31Z","labels":{"addonmanager.kubernetes.io/mode":"Reconcile","integration-test":"storage-provisioner"},"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"Pod\",\"metadata\":{\"annotations\":{},\"labels\":{\"addonmanager.kubernetes.io/mode\":\"Reconcile\",\"integration-test\":\"storage-provisioner\"},\"name\":\"storage-provisioner\",\"namespace\":\"kube-system\"},\"spec\":{\"containers\":[{\"command\":[\"/storage-provisioner\"],\"image\":\"gcr.io/k8s-minikube/storage-provisioner:v1.8.1\",\"imagePullPolicy\":\"IfNotPresent\",\"name\":\"storage-provisioner\",\"volumeMounts\":[{\"mountPath\":\"/tmp\",\"name\":\"tmp\"}]}],\"hostNetwork\":true,\"serviceAccountName\":\"storage-provisioner\",\"volumes\":[{\"hostPath\":{\"path\":\"/tmp\",\"type\":\"Directory\"},\"name\":\"tmp\"}]}}\n"}},"spec":{"volumes":[{"name":"tmp","hostPath":{"path":"/tmp","type":"Directory"}},{"name":"storage-provisioner-token-d8knb","secret":{"secretName":"storage-provisioner-token-d8knb","defaultMode":420}}],"containers":[{"name":"storage-provisioner","image":"gcr.io/k8s-minikube/storage-provisioner:v1.8.1","command":["/storage-provisioner"],"resources":{},"volumeMounts":[{"name":"tmp","mountPath":"/tmp"},{"name":"storage-provisioner-token-d8knb","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"storage-provisioner","serviceAccount":"storage-provisioner","nodeName":"minikube","hostNetwork":true,"securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:31Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:36Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:36Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T12:28:31Z"}],"hostIP":"192.168.122.33","podIP":"192.168.122.33","startTime":"2019-03-15T12:28:31Z","containerStatuses":[{"name":"storage-provisioner","state":{"running":{"startedAt":"2019-03-15T12:28:36Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"gcr.io/k8s-minikube/storage-provisioner:v1.8.1","imageID":"docker-pullable://gcr.io/k8s-minikube/storage-provisioner@sha256:088daa9fcbccf04c3f415d77d5a6360d2803922190b675cb7fc88a9d2d91985a","containerID":"docker://82b729f54e273d0f44a0c65efa4417cd5269576bf44c2eeb5ac199d6453c80b2"}],"qosClass":"BestEffort"}},{"metadata":{"name":"hello-1552663560-tszfw","generateName":"hello-1552663560-","namespace":"test","selfLink":"/api/v1/namespaces/test/pods/hello-1552663560-tszfw","uid":"a895c168-4736-11e9-939b-48cec360726b","resourceVersion":"19325","creationTimestamp":"2019-03-15T15:26:09Z","labels":{"controller-uid":"a8878c14-4736-11e9-939b-48cec360726b","job-name":"hello-1552663560"},"ownerReferences":[{"apiVersion":"batch/v1","kind":"Job","name":"hello-1552663560","uid":"a8878c14-4736-11e9-939b-48cec360726b","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"default-token-wzmzc","secret":{"secretName":"default-token-wzmzc","defaultMode":420}}],"containers":[{"name":"hello","image":"hello-world","resources":{},"volumeMounts":[{"name":"default-token-wzmzc","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"OnFailure","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"minikube","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Succeeded","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:26:09Z","reason":"PodCompleted"},{"type":"Ready","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:26:09Z","reason":"PodCompleted"},{"type":"ContainersReady","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:26:09Z","reason":"PodCompleted"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:26:09Z"}],"hostIP":"192.168.122.33","podIP":"172.17.0.8","startTime":"2019-03-15T15:26:09Z","containerStatuses":[{"name":"hello","state":{"terminated":{"exitCode":0,"reason":"Completed","startedAt":"2019-03-15T15:26:11Z","finishedAt":"2019-03-15T15:26:11Z","containerID":"docker://a395e4148ce0613ad4d209731b6c86f9a2c8032185dfa4a69457bee45df2be80"}},"lastState":{},"ready":false,"restartCount":0,"image":"hello-world:latest","imageID":"docker-pullable://hello-world@sha256:2557e3c07ed1e38f26e389462d03ed943586f744621577a99efb77324b0fe535","containerID":"docker://a395e4148ce0613ad4d209731b6c86f9a2c8032185dfa4a69457bee45df2be80"}],"qosClass":"BestEffort"}},{"metadata":{"name":"nginx-7cdbd8cdc9-sc6td","generateName":"nginx-7cdbd8cdc9-","namespace":"test","selfLink":"/api/v1/namespaces/test/pods/nginx-7cdbd8cdc9-sc6td","uid":"811965fb-4736-11e9-939b-48cec360726b","resourceVersion":"19228","creationTimestamp":"2019-03-15T15:25:03Z","labels":{"pod-template-hash":"7cdbd8cdc9","run":"nginx"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"nginx-7cdbd8cdc9","uid":"8066eb56-4736-11e9-939b-48cec360726b","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"default-token-wzmzc","secret":{"secretName":"default-token-wzmzc","defaultMode":420}}],"containers":[{"name":"nginx","image":"nginx","resources":{},"volumeMounts":[{"name":"default-token-wzmzc","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"minikube","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:03Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:09Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:09Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:03Z"}],"hostIP":"192.168.122.33","podIP":"172.17.0.7","startTime":"2019-03-15T15:25:03Z","containerStatuses":[{"name":"nginx","state":{"running":{"startedAt":"2019-03-15T15:25:08Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"nginx:latest","imageID":"docker-pullable://nginx@sha256:98efe605f61725fd817ea69521b0eeb32bef007af0e3d0aeb6258c6e6fe7fc1a","containerID":"docker://53080cf4f54f5cdcde0cef11bfd5c2c1f504a54def8c98f8afda1e8593f626f0"}],"qosClass":"BestEffort"}},{"metadata":{"name":"nginx-pod","namespace":"test","selfLink":"/api/v1/namespaces/test/pods/nginx-pod","uid":"8085abe6-4736-11e9-939b-48cec360726b","resourceVersion":"19227","creationTimestamp":"2019-03-15T15:25:02Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"Pod\",\"metadata\":{\"annotations\":{},\"name\":\"nginx-pod\",\"namespace\":\"test\"},\"spec\":{\"containers\":[{\"image\":\"nginx\",\"name\":\"nginx\"}]}}\n"}},"spec":{"volumes":[{"name":"default-token-wzmzc","secret":{"secretName":"default-token-wzmzc","defaultMode":420}}],"containers":[{"name":"nginx","image":"nginx","resources":{},"volumeMounts":[{"name":"default-token-wzmzc","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"minikube","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:02Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:09Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:09Z"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-03-15T15:25:02Z"}],"hostIP":"192.168.122.33","podIP":"172.17.0.6","startTime":"2019-03-15T15:25:02Z","containerStatuses":[{"name":"nginx","state":{"running":{"startedAt":"2019-03-15T15:25:07Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"nginx:latest","imageID":"docker-pullable://nginx@sha256:98efe605f61725fd817ea69521b0eeb32bef007af0e3d0aeb6258c6e6fe7fc1a","containerID":"docker://2ec37c947b0b0f4f078b33b9118d95b7b5a1e65f269f50b4f7bf8f99e2a85308"}],"qosClass":"BestEffort"}}]}

        '
    headers:
      Content-Type:
      - application/json
      Date:
      - Fri, 15 Mar 2019 15:26:56 GMT
    status:
      code: 200
      message: OK
- request:
    body: '{"metadata":{"name":"test.nginx","namespace":"test","regex":"nginx-%5B%5E-%5D%2B-%5B%5E-%5D%2B","kibana_url":"https://kibana.example.com","kibana_dashboard":"","docs":"","xpack":{"type":"json"},"window":"300s"},"trigger":{"schedule":{"interval":"30s"}},"input":{"search":{"request":{"search_type":"query_then_fetch","indices":["overridden-pattern-*"],"types":[],"body":{"aggs":{"result":{"top_hits":{"size":1}},"pods":{"cardinality":{"field":"kubernetes.pod.name"}},"not_ready":{"terms":{"field":"kubernetes.pod.name","min_doc_count":12,"size":100}}},"query":{"bool":{"must_not":[{"match":{"kubernetes.pod.status.ready":"true"}}],"must":[{"regexp":{"kubernetes.pod.name":"nginx-[^-]+-[^-]+"}},{"match":{"kubernetes.namespace":"test"}},{"match":{"metricset.name":"state_pod"}}],"filter":[{"range":{"@timestamp":{"gte":"now-{{ctx.metadata.window}}"}}}]}}}}}},"condition":{"compare":{"ctx.payload.aggregations.not_ready.buckets":{"not_eq":[]}}},"actions":{"email_admin":{"throttle_period_in_millis":3600000,"email":{"profile":"standard","subject":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}{{ctx.metadata.name}}
      has {{ctx.payload.aggregations.pods.value}} not ready pod(s){{/ctx.payload.aggregations.result.hits.hits.0._source}}","body":{"html":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}<a
      href=\"{{ctx.metadata.kibana_url}}/app/kibana#/discover?_a=(columns:!(_source),filters:!((''$state'':(store:appState),meta:(alias:!n,disabled:!f,index:''metricbeat-*'',key:query,negate:!f,type:custom,value:''''),query:(bool:(must:!((regexp:(kubernetes.pod.name:''{{ctx.metadata.regex}}'')),(match:(metricset.name:''state_pod'')),(match:(kubernetes.namespace:{{ctx.metadata.namespace}}))))))),index:''metricbeat-*'',interval:auto,query:(language:lucene,query:''''),regexp:(language:lucene,query:''kubernetes.pod.name:test-nginx-%5B%5E-%5D%20-%5B%5E-%5D%20''),sort:!(''@timestamp'',desc),time:(from:now%2FM,mode:quick,to:now%2FM))&_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-15m,mode:quick,to:now))\">{{ctx.metadata.name}}</a>
      has {{ctx.payload.aggregations.pods.value}} not ready pod(s) <a href=\"{{ctx.metadata.kibana_url}}/app/kibana#/management/elasticsearch/watcher/watches/watch/{{ctx.metadata.name}}\">[ack]</a>{{#ctx.metadata.docs}}
      <a href=\"{{.}}\">[docs]</a>{{/ctx.metadata.docs}}{{/ctx.payload.aggregations.result.hits.hits.0._source}}"},"to":["michael.russell@elastic.co"]}},"notify-slack":{"throttle_period_in_millis":3600000,"slack":{"message":{"text":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}*<{{ctx.metadata.kibana_url}}/app/kibana#/discover?_a=(columns:!(_source),filters:!((''$state'':(store:appState),meta:(alias:!n,disabled:!f,index:''metricbeat-*'',key:query,negate:!f,type:custom,value:''''),query:(bool:(must:!((regexp:(kubernetes.pod.name:''{{ctx.metadata.regex}}'')),(match:(metricset.name:''state_pod'')),(match:(kubernetes.namespace:{{ctx.metadata.namespace}}))))))),index:''metricbeat-*'',interval:auto,query:(language:lucene,query:''''),regexp:(language:lucene,query:''kubernetes.pod.name:test-nginx-%5B%5E-%5D%20-%5B%5E-%5D%20''),sort:!(''@timestamp'',desc),time:(from:now%2FM,mode:quick,to:now%2FM))&_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-15m,mode:quick,to:now))|{{ctx.metadata.name}}>*
      has `{{ctx.payload.aggregations.pods.value}}` not ready pod(s) <{{ctx.metadata.kibana_url}}/app/kibana#/management/elasticsearch/watcher/watches/watch/{{ctx.metadata.name}}|[ack]>{{#ctx.metadata.docs}}
      <{{.}}|[docs]>{{/ctx.metadata.docs}}{{/ctx.payload.aggregations.result.hits.hits.0._source}}","to":["@michael.russell"]}}}}}'
    headers:
      connection:
      - keep-alive
      content-type:
      - application/json
    method: PUT
    uri: http://localhost:9200/_xpack/watcher/watch/test.nginx
  response:
    body:
      string: '{"_id":"test.nginx","_version":2,"created":false}'
    headers:
      content-length:
      - '49'
      content-type:
      - application/json; charset=UTF-8
    status:
      code: 200
      message: OK
- request:
    body: '{"metadata":{"name":"test.hello","namespace":"test","regex":"hello-%5B%5E-%5D%2B-%5B%5E-%5D%2B","kibana_url":"https://kibana.example.com","kibana_dashboard":"","docs":"","xpack":{"type":"json"},"window":"300s"},"trigger":{"schedule":{"interval":"30s"}},"input":{"search":{"request":{"search_type":"query_then_fetch","indices":["overridden-pattern-*"],"types":[],"body":{"aggs":{"result":{"top_hits":{"size":1}},"pods":{"cardinality":{"field":"kubernetes.pod.name"}},"not_ready":{"terms":{"field":"kubernetes.pod.name","min_doc_count":12,"size":100}}},"query":{"bool":{"must_not":[{"match":{"kubernetes.pod.status.phase":"running"}},{"match":{"kubernetes.pod.status.phase":"pending"}}],"must":[{"regexp":{"kubernetes.pod.name":"hello-[^-]+-[^-]+"}},{"match":{"kubernetes.namespace":"test"}},{"match":{"metricset.name":"state_pod"}}],"filter":[{"range":{"@timestamp":{"gte":"now-{{ctx.metadata.window}}"}}}]}},"size":2,"sort":[{"kubernetes.pod.name":{"order":"desc","mode":"max"}}]}}}},"condition":{"script":{"lang":"painless","source":"for
      (h in ctx.payload.hits.hits) { if (h._source.kubernetes.pod.status.phase ==
      ''succeeded'') return false; } return true;"}},"actions":{"email_admin":{"throttle_period_in_millis":3600000,"email":{"profile":"standard","subject":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}{{ctx.metadata.name}}
      has {{ctx.payload.aggregations.pods.value}} not ready pod(s){{/ctx.payload.aggregations.result.hits.hits.0._source}}","body":{"html":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}<a
      href=\"{{ctx.metadata.kibana_url}}/app/kibana#/discover?_a=(columns:!(_source),filters:!((''$state'':(store:appState),meta:(alias:!n,disabled:!f,index:''metricbeat-*'',key:query,negate:!f,type:custom,value:''''),query:(bool:(must:!((regexp:(kubernetes.pod.name:''{{ctx.metadata.regex}}'')),(match:(metricset.name:''state_pod'')),(match:(kubernetes.namespace:{{ctx.metadata.namespace}}))))))),index:''metricbeat-*'',interval:auto,query:(language:lucene,query:''''),regexp:(language:lucene,query:''kubernetes.pod.name:test-nginx-%5B%5E-%5D%20-%5B%5E-%5D%20''),sort:!(''@timestamp'',desc),time:(from:now%2FM,mode:quick,to:now%2FM))&_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-15m,mode:quick,to:now))\">{{ctx.metadata.name}}</a>
      has {{ctx.payload.aggregations.pods.value}} not ready pod(s) <a href=\"{{ctx.metadata.kibana_url}}/app/kibana#/management/elasticsearch/watcher/watches/watch/{{ctx.metadata.name}}\">[ack]</a>{{#ctx.metadata.docs}}
      <a href=\"{{.}}\">[docs]</a>{{/ctx.metadata.docs}}{{/ctx.payload.aggregations.result.hits.hits.0._source}}"},"to":["michael.russell@elastic.co"]}},"notify-slack":{"throttle_period_in_millis":3600000,"slack":{"message":{"text":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}*<{{ctx.metadata.kibana_url}}/app/kibana#/discover?_a=(columns:!(_source),filters:!((''$state'':(store:appState),meta:(alias:!n,disabled:!f,index:''metricbeat-*'',key:query,negate:!f,type:custom,value:''''),query:(bool:(must:!((regexp:(kubernetes.pod.name:''{{ctx.metadata.regex}}'')),(match:(metricset.name:''state_pod'')),(match:(kubernetes.namespace:{{ctx.metadata.namespace}}))))))),index:''metricbeat-*'',interval:auto,query:(language:lucene,query:''''),regexp:(language:lucene,query:''kubernetes.pod.name:test-nginx-%5B%5E-%5D%20-%5B%5E-%5D%20''),sort:!(''@timestamp'',desc),time:(from:now%2FM,mode:quick,to:now%2FM))&_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-15m,mode:quick,to:now))|{{ctx.metadata.name}}>*
      has `{{ctx.payload.aggregations.pods.value}}` not ready pod(s) <{{ctx.metadata.kibana_url}}/app/kibana#/management/elasticsearch/watcher/watches/watch/{{ctx.metadata.name}}|[ack]>{{#ctx.metadata.docs}}
      <{{.}}|[docs]>{{/ctx.metadata.docs}}{{/ctx.payload.aggregations.result.hits.hits.0._source}}","to":["@michael.russell"]}}}}}'
    headers:
      connection:
      - keep-alive
      content-type:
      - application/json
    method: PUT
    uri: http://localhost:9200/_xpack/watcher/watch/test.hello
  response:
    body:
      string: '{"_id":"test.hello","_version":2,"created":false}'
    headers:
      content-length:
      - '49'
      content-type:
      - application/json; charset=UTF-8
    status:
      code: 200
      message: OK
- request:
    body: '{"metadata":{"window":"300s","subject":"No metricbeat data has been recieved
      in the last 5 minutes!","message":"No metricbeat data has been recieved in the
      last 5 minutes! <https://kibana.example.com|kibana>"},"trigger":{"schedule":{"interval":"60s"}},"input":{"search":{"request":{"search_type":"query_then_fetch","indices":["overridden-pattern-*"],"types":[],"body":{"query":{"bool":{"must":[{"match":{"metricset.name":"state_pod"}}],"filter":[{"range":{"@timestamp":{"gte":"now-{{ctx.metadata.window}}"}}}]}}}}}},"condition":{"compare":{"ctx.payload.hits.total":{"eq":0}}},"actions":{"email_admin":{"throttle_period_in_millis":3600000,"email":{"profile":"standard","subject":"{{ctx.metadata.subject}}","body":{"text":"{{ctx.metadata.message}}"},"to":["michael.russell@elastic.co"]}},"notify-slack":{"throttle_period_in_millis":3600000,"slack":{"message":{"text":"{{ctx.metadata.message}}","to":["@michael.russell"]}}}}}'
    headers:
      connection:
      - keep-alive
      content-type:
      - application/json
    method: PUT
    uri: http://localhost:9200/_xpack/watcher/watch/metricbeat
  response:
    body:
      string: '{"_id":"metricbeat","_version":2,"created":false}'
    headers:
      content-length:
      - '49'
      content-type:
      - application/json; charset=UTF-8
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      connection:
      - keep-alive
      content-type:
      - application/json
    method: GET
    uri: http://localhost:9200/.watches/_search?size=1000
  response:
    body:
      string: '{"took":3,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":4,"max_score":1.0,"hits":[{"_index":".watches","_type":"doc","_id":"disabled.nginx","_score":1.0,"_source":{"trigger":{"schedule":{"interval":"30s"}},"input":{"search":{"request":{"search_type":"query_then_fetch","indices":["metricbeat-*"],"types":[],"body":{"aggs":{"result":{"top_hits":{"size":1}},"pods":{"cardinality":{"field":"kubernetes.pod.name"}},"not_ready":{"terms":{"field":"kubernetes.pod.name","min_doc_count":12,"size":100}}},"query":{"bool":{"must_not":[{"match":{"kubernetes.pod.status.ready":"true"}}],"must":[{"regexp":{"kubernetes.pod.name":"nginx-[^-]+-[^-]+"}},{"match":{"kubernetes.namespace":"disabled"}},{"match":{"metricset.name":"state_pod"}}],"filter":[{"range":{"@timestamp":{"gte":"now-{{ctx.metadata.window}}"}}}]}}}}}},"condition":{"compare":{"ctx.payload.aggregations.not_ready.buckets":{"not_eq":[]}}},"actions":{},"metadata":{"regex":"nginx-%5B%5E-%5D%2B-%5B%5E-%5D%2B","docs":"","name":"disabled.nginx","namespace":"disabled","window":"300s","kibana_url":"https://kibana.example.com","kibana_dashboard":"","xpack":{"type":"json"}},"status":{"state":{"active":true,"timestamp":"2019-03-15T15:26:53.124Z"},"actions":{},"headers":{"_xpack_security_authentication":"w6XxAgAHZWxhc3RpYwEJc3VwZXJ1c2VyCgEJX3Jlc2VydmVkBQEAAAEAB3ZKWGJMRG4IcmVzZXJ2ZWQIcmVzZXJ2ZWQA"},"version":-1}}},{"_index":".watches","_type":"doc","_id":"test.nginx","_score":1.0,"_source":{"trigger":{"schedule":{"interval":"30s"}},"input":{"search":{"request":{"search_type":"query_then_fetch","indices":["overridden-pattern-*"],"types":[],"body":{"aggs":{"result":{"top_hits":{"size":1}},"pods":{"cardinality":{"field":"kubernetes.pod.name"}},"not_ready":{"terms":{"field":"kubernetes.pod.name","min_doc_count":12,"size":100}}},"query":{"bool":{"must_not":[{"match":{"kubernetes.pod.status.ready":"true"}}],"must":[{"regexp":{"kubernetes.pod.name":"nginx-[^-]+-[^-]+"}},{"match":{"kubernetes.namespace":"test"}},{"match":{"metricset.name":"state_pod"}}],"filter":[{"range":{"@timestamp":{"gte":"now-{{ctx.metadata.window}}"}}}]}}}}}},"condition":{"compare":{"ctx.payload.aggregations.not_ready.buckets":{"not_eq":[]}}},"actions":{"email_admin":{"throttle_period_in_millis":3600000,"email":{"profile":"standard","to":["michael.russell@elastic.co"],"subject":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}{{ctx.metadata.name}}
        has {{ctx.payload.aggregations.pods.value}} not ready pod(s){{/ctx.payload.aggregations.result.hits.hits.0._source}}","body":{"html":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}<a
        href=\"{{ctx.metadata.kibana_url}}/app/kibana#/discover?_a=(columns:!(_source),filters:!((''$state'':(store:appState),meta:(alias:!n,disabled:!f,index:''metricbeat-*'',key:query,negate:!f,type:custom,value:''''),query:(bool:(must:!((regexp:(kubernetes.pod.name:''{{ctx.metadata.regex}}'')),(match:(metricset.name:''state_pod'')),(match:(kubernetes.namespace:{{ctx.metadata.namespace}}))))))),index:''metricbeat-*'',interval:auto,query:(language:lucene,query:''''),regexp:(language:lucene,query:''kubernetes.pod.name:test-nginx-%5B%5E-%5D%20-%5B%5E-%5D%20''),sort:!(''@timestamp'',desc),time:(from:now%2FM,mode:quick,to:now%2FM))&_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-15m,mode:quick,to:now))\">{{ctx.metadata.name}}</a>
        has {{ctx.payload.aggregations.pods.value}} not ready pod(s) <a href=\"{{ctx.metadata.kibana_url}}/app/kibana#/management/elasticsearch/watcher/watches/watch/{{ctx.metadata.name}}\">[ack]</a>{{#ctx.metadata.docs}}
        <a href=\"{{.}}\">[docs]</a>{{/ctx.metadata.docs}}{{/ctx.payload.aggregations.result.hits.hits.0._source}}"}}},"notify-slack":{"throttle_period_in_millis":3600000,"slack":{"message":{"to":["@michael.russell"],"text":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}*<{{ctx.metadata.kibana_url}}/app/kibana#/discover?_a=(columns:!(_source),filters:!((''$state'':(store:appState),meta:(alias:!n,disabled:!f,index:''metricbeat-*'',key:query,negate:!f,type:custom,value:''''),query:(bool:(must:!((regexp:(kubernetes.pod.name:''{{ctx.metadata.regex}}'')),(match:(metricset.name:''state_pod'')),(match:(kubernetes.namespace:{{ctx.metadata.namespace}}))))))),index:''metricbeat-*'',interval:auto,query:(language:lucene,query:''''),regexp:(language:lucene,query:''kubernetes.pod.name:test-nginx-%5B%5E-%5D%20-%5B%5E-%5D%20''),sort:!(''@timestamp'',desc),time:(from:now%2FM,mode:quick,to:now%2FM))&_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-15m,mode:quick,to:now))|{{ctx.metadata.name}}>*
        has `{{ctx.payload.aggregations.pods.value}}` not ready pod(s) <{{ctx.metadata.kibana_url}}/app/kibana#/management/elasticsearch/watcher/watches/watch/{{ctx.metadata.name}}|[ack]>{{#ctx.metadata.docs}}
        <{{.}}|[docs]>{{/ctx.metadata.docs}}{{/ctx.payload.aggregations.result.hits.hits.0._source}}"}}}},"metadata":{"regex":"nginx-%5B%5E-%5D%2B-%5B%5E-%5D%2B","docs":"","name":"test.nginx","namespace":"test","window":"300s","kibana_url":"https://kibana.example.com","kibana_dashboard":"","xpack":{"type":"json"}},"status":{"state":{"active":true,"timestamp":"2019-03-15T15:26:54.453Z"},"actions":{"email_admin":{"ack":{"timestamp":"2019-03-15T15:26:54.453Z","state":"awaits_successful_execution"}},"notify-slack":{"ack":{"timestamp":"2019-03-15T15:26:54.453Z","state":"awaits_successful_execution"}}},"headers":{"_xpack_security_authentication":"w6XxAgAHZWxhc3RpYwEJc3VwZXJ1c2VyCgEJX3Jlc2VydmVkBQEAAAEAB3ZKWGJMRG4IcmVzZXJ2ZWQIcmVzZXJ2ZWQA"},"version":-1}}},{"_index":".watches","_type":"doc","_id":"test.hello","_score":1.0,"_source":{"trigger":{"schedule":{"interval":"30s"}},"input":{"search":{"request":{"search_type":"query_then_fetch","indices":["overridden-pattern-*"],"types":[],"body":{"aggs":{"result":{"top_hits":{"size":1}},"pods":{"cardinality":{"field":"kubernetes.pod.name"}},"not_ready":{"terms":{"field":"kubernetes.pod.name","min_doc_count":12,"size":100}}},"query":{"bool":{"must_not":[{"match":{"kubernetes.pod.status.phase":"running"}},{"match":{"kubernetes.pod.status.phase":"pending"}}],"must":[{"regexp":{"kubernetes.pod.name":"hello-[^-]+-[^-]+"}},{"match":{"kubernetes.namespace":"test"}},{"match":{"metricset.name":"state_pod"}}],"filter":[{"range":{"@timestamp":{"gte":"now-{{ctx.metadata.window}}"}}}]}},"size":2,"sort":[{"kubernetes.pod.name":{"order":"desc","mode":"max"}}]}}}},"condition":{"script":{"source":"for
        (h in ctx.payload.hits.hits) { if (h._source.kubernetes.pod.status.phase ==
        ''succeeded'') return false; } return true;","lang":"painless"}},"actions":{"email_admin":{"throttle_period_in_millis":3600000,"email":{"profile":"standard","to":["michael.russell@elastic.co"],"subject":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}{{ctx.metadata.name}}
        has {{ctx.payload.aggregations.pods.value}} not ready pod(s){{/ctx.payload.aggregations.result.hits.hits.0._source}}","body":{"html":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}<a
        href=\"{{ctx.metadata.kibana_url}}/app/kibana#/discover?_a=(columns:!(_source),filters:!((''$state'':(store:appState),meta:(alias:!n,disabled:!f,index:''metricbeat-*'',key:query,negate:!f,type:custom,value:''''),query:(bool:(must:!((regexp:(kubernetes.pod.name:''{{ctx.metadata.regex}}'')),(match:(metricset.name:''state_pod'')),(match:(kubernetes.namespace:{{ctx.metadata.namespace}}))))))),index:''metricbeat-*'',interval:auto,query:(language:lucene,query:''''),regexp:(language:lucene,query:''kubernetes.pod.name:test-nginx-%5B%5E-%5D%20-%5B%5E-%5D%20''),sort:!(''@timestamp'',desc),time:(from:now%2FM,mode:quick,to:now%2FM))&_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-15m,mode:quick,to:now))\">{{ctx.metadata.name}}</a>
        has {{ctx.payload.aggregations.pods.value}} not ready pod(s) <a href=\"{{ctx.metadata.kibana_url}}/app/kibana#/management/elasticsearch/watcher/watches/watch/{{ctx.metadata.name}}\">[ack]</a>{{#ctx.metadata.docs}}
        <a href=\"{{.}}\">[docs]</a>{{/ctx.metadata.docs}}{{/ctx.payload.aggregations.result.hits.hits.0._source}}"}}},"notify-slack":{"throttle_period_in_millis":3600000,"slack":{"message":{"to":["@michael.russell"],"text":"{{#ctx.payload.aggregations.result.hits.hits.0._source}}*<{{ctx.metadata.kibana_url}}/app/kibana#/discover?_a=(columns:!(_source),filters:!((''$state'':(store:appState),meta:(alias:!n,disabled:!f,index:''metricbeat-*'',key:query,negate:!f,type:custom,value:''''),query:(bool:(must:!((regexp:(kubernetes.pod.name:''{{ctx.metadata.regex}}'')),(match:(metricset.name:''state_pod'')),(match:(kubernetes.namespace:{{ctx.metadata.namespace}}))))))),index:''metricbeat-*'',interval:auto,query:(language:lucene,query:''''),regexp:(language:lucene,query:''kubernetes.pod.name:test-nginx-%5B%5E-%5D%20-%5B%5E-%5D%20''),sort:!(''@timestamp'',desc),time:(from:now%2FM,mode:quick,to:now%2FM))&_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-15m,mode:quick,to:now))|{{ctx.metadata.name}}>*
        has `{{ctx.payload.aggregations.pods.value}}` not ready pod(s) <{{ctx.metadata.kibana_url}}/app/kibana#/management/elasticsearch/watcher/watches/watch/{{ctx.metadata.name}}|[ack]>{{#ctx.metadata.docs}}
        <{{.}}|[docs]>{{/ctx.metadata.docs}}{{/ctx.payload.aggregations.result.hits.hits.0._source}}"}}}},"metadata":{"regex":"hello-%5B%5E-%5D%2B-%5B%5E-%5D%2B","docs":"","name":"test.hello","namespace":"test","window":"300s","kibana_url":"https://kibana.example.com","kibana_dashboard":"","xpack":{"type":"json"}},"status":{"state":{"active":true,"timestamp":"2019-03-15T15:26:54.526Z"},"actions":{"email_admin":{"ack":{"timestamp":"2019-03-15T15:26:54.526Z","state":"awaits_successful_execution"}},"notify-slack":{"ack":{"timestamp":"2019-03-15T15:26:54.526Z","state":"awaits_successful_execution"}}},"headers":{"_xpack_security_authentication":"w6XxAgAHZWxhc3RpYwEJc3VwZXJ1c2VyCgEJX3Jlc2VydmVkBQEAAAEAB3ZKWGJMRG4IcmVzZXJ2ZWQIcmVzZXJ2ZWQA"},"version":-1}}},{"_index":".watches","_type":"doc","_id":"metricbeat","_score":1.0,"_source":{"trigger":{"schedule":{"interval":"60s"}},"input":{"search":{"request":{"search_type":"query_then_fetch","indices":["overridden-pattern-*"],"types":[],"body":{"query":{"bool":{"must":[{"match":{"metricset.name":"state_pod"}}],"filter":[{"range":{"@timestamp":{"gte":"now-{{ctx.metadata.window}}"}}}]}}}}}},"condition":{"compare":{"ctx.payload.hits.total":{"eq":0}}},"actions":{"email_admin":{"throttle_period_in_millis":3600000,"email":{"profile":"standard","to":["michael.russell@elastic.co"],"subject":"{{ctx.metadata.subject}}","body":{"text":"{{ctx.metadata.message}}"}}},"notify-slack":{"throttle_period_in_millis":3600000,"slack":{"message":{"to":["@michael.russell"],"text":"{{ctx.metadata.message}}"}}}},"metadata":{"subject":"No
        metricbeat data has been recieved in the last 5 minutes!","window":"300s","message":"No
        metricbeat data has been recieved in the last 5 minutes! <https://kibana.example.com|kibana>"},"status":{"state":{"active":true,"timestamp":"2019-03-15T15:26:54.576Z"},"actions":{"email_admin":{"ack":{"timestamp":"2019-03-15T15:26:54.576Z","state":"awaits_successful_execution"}},"notify-slack":{"ack":{"timestamp":"2019-03-15T15:26:54.576Z","state":"awaits_successful_execution"}}},"headers":{"_xpack_security_authentication":"w6XxAgAHZWxhc3RpYwEJc3VwZXJ1c2VyCgEJX3Jlc2VydmVkBQEAAAEAB3ZKWGJMRG4IcmVzZXJ2ZWQIcmVzZXJ2ZWQA"},"version":-1}}}]}}'
    headers:
      content-length:
      - '11293'
      content-type:
      - application/json; charset=UTF-8
    status:
      code: 200
      message: OK
version: 1
